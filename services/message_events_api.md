# Group Message Events

The Message Events API provides the means to search the raw events generated by SparkPost.

## Using Postman

If you use [Postman](https://www.getpostman.com/) you can click the following button to import the SparkPost API as a collection:

[![Run in Postman](https://s3.amazonaws.com/postman-static/run-button.png)](https://www.getpostman.com/run-collection/81ee1dd2790d7952b76a)


## Copyrights
__**The SparkPost message events API uses MaxMind software [MaxMind License](/docs/3RD_PARTY_LICENSES.md)**__

## Events Documentation [/message-events/events/documentation]

### Documentation [GET]

List descriptions of the event fields that could be included in a response from the Message Events search endpoint. Fields will vary by event type.

+ Request

  + Headers
      Accept: application/json

+ Response 200 (application/json)
  ```js
    {
        "results": [
            {
                "type": {
                    "description": "Type of event this record describes",
                    "sampleValue": "bounce"
                },
                "bounce_class": {
                    "description": "Classification code for a given message (see [Bounce Classification Codes](https://support.sparkpost.com/customer/portal/articles/1929896))",
                    "sampleValue": "1"
                },
                "campaign_id": {
                    "description": "Campaign of which this message was a part",
                    "sampleValue": "Example Campaign Name"
                },
                "customer_id": {
                    "description": "SparkPost-customer identifier through which this message was sent",
                    "sampleValue": "1"
                },
                "delv_method": {
                    "description": "Protocol by which SparkPost delivered this message",
                    "sampleValue": "esmtp"
                },
                "device_token": {
                    "description": "Token of the device / application targeted by this PUSH notification message. Applies only when delv_method is gcm or apn.",
                    "sampleValue": "45c19189783f867973f6e6a5cca60061ffe4fa77c547150563a1192fa9847f8a"
                },
                "error_code": {
                    "description": "Error code by which the remote server described a failed delivery attempt",
                    "sampleValue": "554"
                },
                "ip_address": {
                    "description": "IP address of the host to which SparkPost delivered this message; in engagement events, the IP address of the host where the HTTP request originated",
                    "sampleValue": "127.0.0.1"
                },
                "message_id": {
                    "description": "SparkPost-cluster-wide unique identifier for this message",
                    "sampleValue": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e"
                },
                "msg_from": {
                    "description": "Sender address used on this message's SMTP envelope",
                    "sampleValue": "sender@example.com"
                },
                "msg_size": {
                    "description": "Message's size in bytes",
                    "sampleValue": "1337"
                },
                "num_retries": {
                    "description": "Number of failed attempts before this message was successfully delivered; when the first attempt succeeds, zero",
                    "sampleValue": "2"
                },
                "rcpt_meta": {
                    "description": "Metadata describing the message recipient",
                    "sampleValue": {
                        "customKey": "customValue"
                    }
                },
                "rcpt_tags": {
                    "description": "Tags applied to the message which generated this event",
                    "sampleValue": [
                        "male",
                        "US"
                    ]
                },
                "rcpt_to": {
                    "description": "Recipient address used on this message's SMTP envelope",
                    "sampleValue": "recipient@example.com"
                },
                "rcpt_type": {
                    "description": "Indicates that a recipient address appeared in the Cc or Bcc header or the archive JSON array",
                    "sampleValue": "cc"
                },
                "raw_reason": {
                    "description": "Unmodified, exact response returned by the remote server due to a failed delivery attempt",
                    "sampleValue": "MAIL REFUSED - IP (17.99.99.99) is in black list"
                },
                "reason": {
                    "description": "Canonicalized text of the response returned by the remote server due to a failed delivery attempt",
                    "sampleValue": "MAIL REFUSED - IP (a.b.c.d) is in black list"
                },
                "routing_domain": {
                    "description": "Domain receiving this message",
                    "sampleValue": "example.com"
                },
                "subject": {
                    "description": "Subject line from the email header",
                    "sampleValue": "Summer deals are here!"
                },
                "template_id": {
                    "description": "Slug of the template used to construct this message",
                    "sampleValue": "templ-1234"
                },
                "template_version": {
                    "description": "Version of the template used to construct this message",
                    "sampleValue": "1"
                },
                "timestamp": {
                    "description": "Event date and time, in Unix timestamp format (integer seconds since 00:00:00 GMT 1970-01-01)",
                    "sampleValue": 1427736822
                },
                "transmission_id": {
                    "description": "Transmission which originated this message",
                    "sampleValue": "65832150921904138"
                }
            }
        ]
    }
  ```


## Events Samples [/message-events/events/samples{?events}]

### Samples [GET]

List an example of the event data that will be included in a response from the Message Events search endpoint.

+ Parameters
  + events (optional, string, `bounce`) ... Event types for which to get a sample payload, use the Webhooks Events endpoint to list the available event types, defaults to all event types.

+ Request

  + Headers
      Accept: application/json

+ Response 200 (application/json)
  ```js
    {
        "results": [
            {
                "bounce_class": "1",
                "campaign_id": "Example Campaign Name",
                "customer_id": "1",
                "delv_method": "esmtp",
                "device_token": "45c19189783f867973f6e6a5cca60061ffe4fa77c547150563a1192fa9847f8a",
                "error_code": "554",
                "ip_address": "127.0.0.1",
                "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
                "msg_from": "sender@example.com",
                "msg_size": "1337",
                "num_retries": "2",
                "raw_reason": "MAIL REFUSED - IP (17.99.99.99) is in black list",
                "rcpt_meta": {
                    "customKey": "customValue"
                },
                "rcpt_tags": [
                    "male",
                    "US"
                ],
                "rcpt_to": "recipient@example.com",
                "rcpt_type": "cc",
                "reason": "MAIL REFUSED - IP (a.b.c.d) is in black list",
                "routing_domain": "example.com",
                "subject": "Summer deals are here!",
                "template_id": "templ-1234",
                "template_version": "1",
                "timestamp": 1427736822,
                "transmission_id": "65832150921904138",
                "type": "bounce"
            }
        ]
    }
  ```


## Message Events [/message-events{?bounce_classes,campaign_ids,events,friendly_froms,from,message_ids,page,per_page,reason,recipients,template_ids,timezone,to,transmission_ids}]

### Search for Message Events [GET]

Perform a filtered search for message event data. The response is sorted by descending timestamp.

+ Parameters
    + bounce_classes (optional, number, `1`) ... Comma-delimited list of bounce classification codes to search. (See [Bounce Classification Codes.](https://support.sparkpost.com/customer/portal/articles/1929896))
    + campaign_ids (optional, string, `Example Campaign Name`) ... Comma-delimited list of campaign ID's to search (i.e. campaign_id used during creation of a transmission).
    + events (optional, list, `delivery, injection, bounce, delay, policy_rejection, out_of_band, open, click, generation_failure, generation_rejection, spam_complaint, list_unsubscribe, link_unsubscribe, relay_delivery, relay_injection, relay_permfail, relay_rejection, relay_tempfail`) ... Comma-delimited list of event types to search. Defaults to all event types.
    + friendly_froms (optional, list, `sender@mail.example.com`) ... Comma-delimited list of friendly_froms to search.
    + from = `One hour ago` (optional, datetime, `2014-07-20T08:00`) ... Datetime in format of YYYY-MM-DDTHH:MM.
    + message_ids (optional, list, `0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e`) ... Comma-delimited list of message ID's to search.
    + page = `1` (optional, number, `25`) ... The results page number to return. Used with per_page for paging through results.
    + per_page = `1000` (optional, number, `100`) ... Number of results to return per page. Must be between 1 and 10,000 (inclusive).
    + reason (optional, string, `bounce`) ... Bounce/failure/rejection reason that will be matched using a wildcard (e.g., %reason%).
    + recipients (optional, list, `recipient@example.com`) ... Comma-delimited list of recipients to search.
    + template_ids (optional, list, `templ-1234`) ... Comma-delimited list of template ID's to search.
    + timezone =`UTC` (optional, string, `America/New_York`) ... Standard timezone identification string.
    + to = `now` (optional, datetime, `2014-07-20T09:00`) ... Datetime in format of YYYY-MM-DDTHH:MM.
    + transmission_ids (optional, list, `65832150921904138`) ... Comma-delimited list of transmission ID's to search (i.e. id generated during creation of a transmission).

+ Request

  + Headers

      Accept: application/json
      Authorization: 14ac5499cfdd2bb2859e4476d2e5b1d2bad079bf

+ Response 200 (application/json)
  ```
  {
    "results": [
      {
        "type": "bounce",
        "bounce_class": "1",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "error_code": "554",
        "ip_address": "127.0.0.1",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "msg_from": "sender@example.com",
        "msg_size": "1337",
        "num_retries": "2",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "reason": "000 Example Remote MTA Bounce Message",
        "routing_domain": "example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138"
      },
      {
        "type": "delivery",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "ip_address": "127.0.0.1",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "msg_from": "sender@example.com",
        "msg_size": "1337",
        "num_retries": "2",
        "queue_time": "12",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "routing_domain": "example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138"
      },
      {
        "type": "injection",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "msg_from": "sender@example.com",
        "msg_size": "1337",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "routing_domain": "example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138"
      },
      {
        "type": "spam_complaint",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "fbtype": "abuse",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_to": "recipient@example.com",
        "report_by": "server.email.com",
        "report_to": "abuse.example.com",
        "template_id": "templ-1234",
        "timestamp": "2014-07-20T08:01-00:00",
        "user_str": "Additional Example Information"
      },
      {
        "type": "out_of_band",
        "bounce_class": "1",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "error_code": "554",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "msg_from": "sender@example.com",
        "rcpt_to": "recipient@example.com",
        "reason": "000 Example Remote MTA Bounce Message",
        "routing_domain": "example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": 1427736822
      },
      {
        "type": "policy_rejection",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "error_code": "554",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "msg_from": "sender@example.com",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "reason": "000 Example Remote MTA Bounce Message",
        "remote_addr": "127.0.0.1",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138"
      },
      {
        "type": "delay",
        "bounce_class": "1",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "error_code": "554",
        "ip_address": "127.0.0.1",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "msg_from": "sender@example.com",
        "msg_size": "1337",
        "num_retries": "2",
        "queue_time": "12",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "reason": "000 Example Remote MTA Bounce Message",
        "routing_domain": "example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138"
      },
      {
        "type": "click",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "ip_address": "127.0.0.1",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "target_link_name": "Example Link Name",
        "target_link_url": "http://example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138",
        "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36",
        "geo_ip": {
          "country": "US",
          "region": "MD",
          "city": "Columbia",
          "latitude": "39.1749",
          "longitude": "-76.8375"
        }
      },
      {
        "type": "open",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "ip_address": "127.0.0.1",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138",
        "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36",
        "geo_ip": {
          "country": "US",
          "region": "MD",
          "city": "Columbia",
          "latitude": "39.1749",
          "longitude": "-76.8375"
        }
      },
      {
        "type": "generation_failure",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "error_code": "554",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_subs": {},
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "reason": "000 Example Remote MTA Bounce Message",
        "routing_domain": "example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138"
      },
      {
        "type": "generation_rejection",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "error_code": "554",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_subs": {},
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "reason": "000 Example Remote MTA Bounce Message",
        "routing_domain": "example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138"
      },
      {
        "type": "list_unsubscribe",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "mailfrom": "recipient@example.com",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138"
      },
      {
        "type": "link_unsubscribe",
        "campaign_id": "Example Campaign Name",
        "customer_id": "1",
        "mailfrom": "recipient@example.com",
        "message_id": "0e0d94b7-9085-4e3c-ab30-e3f2cd9c273e",
        "rcpt_meta": {
          "key1": "value1",
          "key2": "value2"
        },
        "rcpt_tags": [
          "male",
          "US"
        ],
        "rcpt_to": "recipient@example.com",
        "template_id": "templ-1234",
        "template_version": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "transmission_id": "65832150921904138",
        "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36"
      },
      {
        "type": "relay_injection",
        "rcpt_to": "recipient@example.com",
        "msg_size": "1337",
        "routing_domain": "example.com",
        "customer_id": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "msg_from": "sender@example.com",
        "relay_id": "123-456-789"
      },
      {
        "type": "relay_rejection",
        "reason": "000 Example Remote MTA Bounce Message",
        "rcpt_to": "recipient@example.com",
        "error_code": "554",
        "msg_from": "sender@example.com",
        "remote_addr": "127.0.0.1",
        "timestamp": "2014-07-20T08:01-00:00",
        "customer_id": "1",
        "relay_id": "123-456-789"
      },
      {
        "type": "relay_delivery",
        "routing_domain": "example.com",
        "msg_from": "sender@example.com",
        "queue_time": "12",
        "customer_id": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "num_retries": "2",
        "relay_id": "123-456-789"
      },
      {
        "type": "relay_tempfail",
        "routing_domain": "example.com",
        "msg_from": "sender@example.com",
        "queue_time": "12",
        "customer_id": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "num_retries": "2",
        "reason": "000 Example Remote MTA Bounce Message",
        "error_code": "554",
        "relay_id": "123-456-789"
      },
      {
        "type": "relay_permfail",
        "routing_domain": "example.com",
        "msg_from": "sender@example.com",
        "queue_time": "12",
        "customer_id": "1",
        "timestamp": "2014-07-20T08:01-00:00",
        "num_retries": "2",
        "reason": "000 Example Remote MTA Bounce Message",
        "error_code": "554",
        "relay_id": "123-456-789"
      }
    ],
    "total_count": 1000,
    "links": [
      {
        "href": "http://example.com/api/v1/message-events?page=1&per_page=10",
        "rel": "first"
      }, {
        "href": "http://example.com/api/v1/xyz?page=50&per_page=10",
        "rel": "previous"
      }, {
        "href": "http://example.com/api/v1/xyz?page=52&per_page=10",
        "rel": "next"
      }, {
        "href": "http://example.com/api/v1/xyz?page=100&per_page=10",
        "rel": "last"
      }    
    ]
  }
  ```
